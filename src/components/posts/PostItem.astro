---
import Author from "@/components/posts/Author.astro";
import Badge from "@/components/ui/Badge.astro";
import Card from "@/components/ui/card/Card.astro";
import CardAction from "@/components/ui/card/CardAction.astro";
import CardDescription from "@/components/ui/card/CardDescription.astro";
import CardHeader from "@/components/ui/card/CardHeader.astro";
import CardTitle from "@/components/ui/card/CardTitle.astro";
import { Image } from "astro:assets";
import type { getCollection } from "astro:content";
import { getEntry } from "astro:content";

type Props = Awaited<ReturnType<typeof getCollection<"posts">>>[number];

const {
  data: {
    slug,
    title,
    tags,
    pubDate,
    cover,
    coverAlt,
    canonicalURL,
    author: { id: authorId },
  },
} = Astro.props;

const author = (await getEntry("team", authorId))?.data;
---
<a href={`/posts/${slug}`}>
  <Card class="relative shadow-md">
    <Image
      src={cover}
      alt={coverAlt}
      class="relative z-20 aspect-video w-full object-cover"
    />
    <CardHeader>
      <CardTitle>{title}</CardTitle>
      <CardAction>
        <ul class="flex flex-wrap gap-2">
          {tags.map(tag => (
            <li>
              <Badge>{tag.toLocaleUpperCase()}</Badge>
            </li>
          ))}
        </ul>
      </CardAction>
    </CardHeader>
    {author && (
      <Author name={author.name} avatar={author.avatar} pubDate={pubDate} />
    )}
  </Card>
</a>
